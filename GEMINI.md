# 프로젝트: 브로큰 애로우 (Broken Arrow)

## 1. 게임 개요 (Overview)
- **장르:** 1:1 동시 턴제 전략 서바이벌
- **컨셉:** 유독 가스가 가득 찬 폐쇄 구역(DMZ)에서 지뢰를 피해 정보를 수집하고, 적보다 먼저 탈출하거나 거점을 장악해야 하는 생존 게임.
- **핵심 재미:**
    - 암전 속의 충돌: 적의 위치가 보이지 않는 상태에서 발생하는 예상치 못한 '충돌'과 길막.
    - 극한의 자원 관리: 회복 수단이 없는 HP(목숨)와 타일별 산소를 이용한 생존 도박.
    - 자원 통제: 타일의 산소를 고갈시켜 상대방에게 피해를 강요.
    - 논리적 추론: 지뢰찾기 로직을 이용한 안전 경로 확보.
    - 정보의 비대칭: 나만 아는 탈출구 위치를 이용해 적을 따돌리는 희열.

## 2. 승리 조건 (Victory Conditions)
최대 30라운드(Turn) 진행, 아래 3가지 조건 중 하나를 먼저 달성하면 즉시 승리.
- **탈출 승리 (Extraction):**
    - 맵 어딘가에 숨겨진 [무전기]를 찾아 작동시킴.
    - 활성화된 [헬기장] 타일에 먼저 도착.
    - 무전기를 찾은 플레이어는 헬기장의 위치가 지도에 표시됨.
- **거점 승리 (Domination):**
    - 30라운드 종료 시점에, 맵에 존재하는 3개의 [통신 탑] 중 2개 이상을 점령하고 있을 것.
- **생존 승리 (Last Man Standing):**
    - 상대방의 사망 (HP 0).

## 3. 게임 진행 방식: 동시 턴 시스템
[Phase 1: 작전 단계 (Command Phase)]
- 두 플레이어는 제한 시간 내에 자신이 수행할 단 하나의 행동을 선택.
- 행동 선택 후 [준비 완료(Ready)] 버튼 클릭.
- 두 플레이어 모두 준비 완료 상태가 되거나 제한 시간이 종료되면 다음 단계로 이동.

[Phase 2: 실행 단계 (Resolution Phase)]
- 서버(또는 게임 로직)가 양쪽의 명령을 동시에 연산하여 결과 판정.
- 이동 판정: 충돌 여부 계산.
- 액션 실행: 이동, 정찰, 대기, 점령 결과 반영.
- 상태 갱신: 산소 감소, HP 변화, 지뢰 폭발, 시야 갱신 등.

## 4. 맵 및 시야 시스템
- **맵 구조:** 육각형(Hexagon) 그리드 타일.
- **안개 (Fog of War):** 가보지 못한 곳은 볼 수 없음.
- **시야 (Vision):**
    - 내 시야: 현재 캐릭터 위치 기준 주변 6칸(지뢰 개수 힌트) + 한 번이라도 밝힌(방문/정찰) 모든 타일 (영구 시야).
- **정보의 스냅샷 (Snapshot Rule):**
    - 밝혀진 타일이라도 정보는 마지막 확인 시점 상태로 고정.
    - 예: 내가 떠난 뒤 상대가 산소를 소모했어도 다시 확인 전까진 예전 상태로 보임.
    - 예: 지뢰 폭발 시 타일 색상 변화가 발생하며, 다시 시야를 밝히면 변경된 정보 확인 가능.
- **적 시야:** 보이지 않음 (Invisible). '충돌'이나 '지뢰 폭발 알림'으로만 유추.

## 5. 핵심 자원: 산소 (Oxygen) & HP
### A. 산소 (Tile Resource)
- 각 타일에 매장된 공공 자원 (공유).
- 용량: 모든 안전 타일은 최대 3칸의 산소 보유.
- 소모: 어떤 행동이든 수행 시 현재 타일의 산소 1 감소.

### B. 고갈 구역 (Depleted Zone)
- 타일의 산소가 0인 경우.
- **패널티 (질식):** 산소 없는 곳에서 행동(이동 포함) 시 HP 1 소모.

### C. 체력 (HP)
- 최대치: 3칸.
- 감소: 지뢰 밟음 (-1), 산소 0인 타일에서 행동 수행 (-1).
- **회복 불가.**

## 6. 플레이어 행동 (Actions)
모든 행동은 현재 타일의 산소 1 소모.
1. **이동 (Move):** 인접 타일 이동.
    - 충돌: 이미 상대가 있는 타일 진입 불가(UI 비활성), 동시 진입 시 둘 다 원래 자리로 복귀.
    - 교차 이동: 허용됨.
2. **정찰 (Recon):** 인접 타일 1곳 지정 확인. 상태 100% 파악 및 영구 시야 확보.
3. **대기 (Hold):** 제자리에서 산소 소모하며 대기.
4. **점령 (Capture):** [통신 탑] 타일 위에서 소유권 변경.

## 7. 오브젝트 및 이벤트
### A. 지뢰 (Mine)
- **생성 로직:**
    1. **안전 구역:** 시작 지점, 시작 지점 주변 6칸, 주요 오브젝트(탑, 헬기장) 위치는 절대 안전.
    2. **경로 보장:** 시작점에서 모든 주요 오브젝트까지 이어지는 최소 1개의 안전 경로가 보장됨 (Path Carving).
    3. **고립 방지:** 생성 후 검증(Flood Fill)을 통해 도달 불가능한 오브젝트가 있으면 맵을 재생성.
    4. **완전 포위 방지:** 어떤 안전 타일도 6면이 모두 지뢰로 막히지 않도록 보정.
- **효과:** 밟는 순간 폭발, HP -1.
- 제자리 유지 (진입 성공), 폭발 후 지뢰 제거됨.
- **상대방 알림:** 상대방 화면 가장자리에 폭발 방향 화살표 표시.
### B. 헬기장
- 무전기 작동 전 비활성. 무전기 획득 시 위치 표시.
- 직접 시야 확보 시 무전기 없어도 확인 가능.
### C. 통신 탑 (3개)
- 점령 시 주변 시야 영구 확보. 30턴 종료 시 승리 조건. 위치는 처음부터 공개.
### D. 보급품
- **산소마스크:** 산소 0 타일에서 HP 감소 1회 방지 (소모성, 중복 불가).
- **무전기:** 1개 존재. 획득 시 전원 알림 및 획득자에게 헬기장 위치 공개.
- **금속탐지기:** 주위 6칸 지뢰 위치 정확히 파악 (소모성).
